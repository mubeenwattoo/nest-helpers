<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="./assets/css/output.css" rel="stylesheet" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">

<title>Guest Survey Page 1</title>
<!-- Contentsquare (Hotjar) Tracking -->
<script src="https://t.contentsquare.net/uxa/ce07a67e879d5.js"></script>
</head>
<body class="font-[lexend]">

 <section class="gradient-bg pt-8  lg:px-[64px] lg:pb-[48px] pb-[24px] p-6 ">
  <div class="max-w-[1440px] mx-auto">
<a href="./" class="inline-flex"><img src="./assets/images/logo.png" alt="logo" class="lg:w-[124px] lg:h-[48px] w-[82px] h-[32px] "></a>


      <h2 class="text-[#5B7B5A] lg:text-[48px] text-[24px] font-[500] lg:mb-10 mb-6 lg:mt-6 mt-12 text-center">Let us find a <br class="lg:hidden block"> great home for you</h2>

  <div class=" mx-auto grid lg:grid-cols-[300px_1fr] gap-20">

    <div class="lg:flex hidden flex-col gap-10">

      <!-- Step 1 -->
      <div class="flex flex-col items-start  gap-3 p-6 rounded-[14px] border-[2px] border-[var(--Color-Green,#5B7B5A)]
  bg-[var(--Color-Light-Green,#D9E1CE)] shadow-[0_20px_25px_-5px_rgba(0,0,0,0.10),_0_8px_10px_-6px_rgba(0,0,0,0.10)] ">
          <span class="mx-auto w-12 h-12 rounded-full bg-[#5B7B5A] text-[24px] font-[300] text-white flex items-center justify-center ">1</span>

            <h3 class="text-[#2D2D2D]  text-[24px] font-[500] mt-3 ">Create Your Profile</h3>
            <p class="text-[#675F57] text-[16px] font-[400]">Tell us about yourself and preferences</p>
      </div>

       <div class="flex flex-col items-start  gap-3 p-6 
  rounded-[14px]
  border-[2px]
  border-[var(--Color-Dark-Brown-30,rgba(103,95,87,0.30))]
  bg-[var(--Color-White-10,rgba(255,255,255,0.10))]
  shadow-[0_20px_25px_-5px_rgba(0,0,0,0.10),_0_8px_10px_-6px_rgba(0,0,0,0.10)]">
          <span class="mx-auto w-12 h-12 rounded-full bg-[var(--Color-White,#FFF)]
  shadow-[0_0_0_2.4px_#FAF8F6,_
          0_6px_9px_-1.8px_rgba(0,0,0,0.10),_
          0_2.4px_3.6px_-2.4px_rgba(0,0,0,0.10)] text-[24px] font-[300] text-[#5B7B5A] flex items-center justify-center ">2</span>

            <h3 class="text-[#2D2D2D]  text-[24px] font-[500] mt-3 ">Get Matched</h3>
            <p class="text-[#675F57] text-[16px] font-[400]">We connect you with households that fit your lifestyle</p>
      </div>
        <div class="flex flex-col items-start  gap-3 p-6 
  rounded-[14px]
  border-[2px]
  border-[var(--Color-Dark-Brown-30,rgba(103,95,87,0.30))]
  bg-[var(--Color-White-10,rgba(255,255,255,0.10))]
  shadow-[0_20px_25px_-5px_rgba(0,0,0,0.10),_0_8px_10px_-6px_rgba(0,0,0,0.10)]">
          <span class="mx-auto w-12 h-12 rounded-full bg-[var(--Color-White,#FFF)]
  shadow-[0_0_0_2.4px_#FAF8F6,_
          0_6px_9px_-1.8px_rgba(0,0,0,0.10),_
          0_2.4px_3.6px_-2.4px_rgba(0,0,0,0.10)] text-[24px] font-[300] text-[#5B7B5A] flex items-center justify-center ">3</span>

            <h3 class="text-[#2D2D2D]  text-[24px] font-[500] mt-3 ">Interview</h3>
            <p class="text-[#675F57] text-[16px] font-[400]">Meet the family, agree on expectations, and move into your new home</p>
      </div>

     

    </div>

    <div>

<form 
  id="surveyForm"
  action="https://sheetdb.io/api/v1/7gh9xr3tsluqb?sheet=Sheet1" 
  method="post"
>
       <div class="flex flex-col gap-8">
      <div class="grid lg:grid-cols-2 items-center lg:gap-14 gap-4">

          <label class="text-[#2D2D2D] lg:text-[20px] text-[16px]  font-[400] lg:text-start text-center ">How long are you hoping to live with and assist a host family?</label>

<div class="dropdown relative w-full">
<input type="hidden" name="data[Duration]" class="dropdown-hidden">
  <button  type="button"
    class="dropdown-btn  w-full text-[#675F57] lg:text-[20px] text-[16px] font-[400]
           h-[44px] px-4 rounded-[10px] border-[2px]
           border-[rgba(103,95,87,0.30)]
           flex items-center justify-between"
  >
    <span class="dropdown-value text-center mx-auto text-[rgba(103,95,87,0.30)]">
      Select
    </span>
    <img src="./assets/images/arrow-down.svg" class="size-4" alt="arrow-down">
  </button>

  <div 
    class=" dropdown-menu hidden absolute left-0 right-0 mt-2  
           border-2 gradient-bg border-[rgba(103,95,87,0.30)]
           rounded-[10px] shadow-lg z-50"
  >
    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
      Less than 3 months
    </div>

    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
      3-6 months
    </div>

    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
      More than 6 months
    </div>
  </div>

</div>




        
      </div>
 <div class="grid lg:grid-cols-2 items-center lg:gap-14 gap-4">

          <label class="text-[#2D2D2D] lg:text-[20px] text-[16px]  font-[400] lg:text-start text-center ">What’s Your Current Work or 
Study Situation?</label>

<div class="dropdown relative w-full">
<input type="hidden" name="data[Study]" class="dropdown-hidden">
  

  <button  type="button"
    class="dropdown-btn  w-full text-[#675F57] lg:text-[20px] text-[16px] font-[400]
           h-[44px] px-4 rounded-[10px] border-[2px]
           border-[rgba(103,95,87,0.30)]
           flex items-center justify-between"
  >
    <span class="dropdown-value text-center mx-auto text-[rgba(103,95,87,0.30)]">
      Select
    </span>
    <img src="./assets/images/arrow-down.svg" class="size-4" alt="arrow-down">
  </button>

  <div 
    class=" dropdown-menu hidden absolute left-0 right-0 mt-2  
           border-2 gradient-bg border-[rgba(103,95,87,0.30)]
           rounded-[10px] shadow-lg z-50"
  >
    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
      I will work/study from home
    </div>

    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD]  cursor-pointer">
      I have a job/study outside of the home
    </div>

    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
    I'm currently in between jobs
    </div>
  </div>

</div>
 

        
      </div>
      <div class="grid lg:grid-cols-2 items-center lg:gap-14 gap-4">

          <label class="text-[#2D2D2D] lg:text-[20px] text-[16px]  font-[400] lg:text-start text-center">Your age and gender </label>
 <div class="flex items-center gap-8 justify-between">

<div class="dropdown relative w-full">
<input type="hidden" name="data[Age]" class="dropdown-hidden">

  <button type="button"
    class="dropdown-btn  w-full text-[#675F57] lg:text-[20px] text-[16px] font-[400]
           h-[44px] px-4 rounded-[10px] border-[2px]
           border-[rgba(103,95,87,0.30)]
           flex items-center justify-between"
  >
    <span class="dropdown-value text-center mx-auto text-[rgba(103,95,87,0.30)]">
      Age
    </span>
    <img src="./assets/images/arrow-down.svg" class="size-4" alt="arrow-down">
  </button>

  <div 
    class=" dropdown-menu hidden absolute left-0 right-0 mt-2  
           border-2 gradient-bg border-[rgba(103,95,87,0.30)]
           rounded-[10px] shadow-lg z-50"
  >
    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
      18-24
    </div>

    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
      25-35
    </div>

    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
      36-45
    </div>
     <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
      46-55
    </div>
     <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
      55+
    </div>
  </div>

</div>

         <div class="dropdown relative w-full">
<input type="hidden" name="data[Gender]" class="dropdown-hidden">

  <button type="button"
    class="dropdown-btn  w-full text-[#675F57] lg:text-[20px] text-[16px] font-[400]
           h-[44px] px-4 rounded-[10px] border-[2px]
           border-[rgba(103,95,87,0.30)]
           flex items-center justify-between"
  >
    <span class="dropdown-value text-center mx-auto text-[rgba(103,95,87,0.30)]">
      Gender
    </span>
    <img src="./assets/images/arrow-down.svg" class="size-4" alt="arrow-down">
  </button>

  <div 
    class=" dropdown-menu hidden absolute left-0 right-0 mt-2  
           border-2 gradient-bg border-[rgba(103,95,87,0.30)]
           rounded-[10px] shadow-lg z-50"
  >
    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
    Male
    </div>

    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
    Female
    </div>

    <div data-option class="px-4 py-2 text-[#675F57] hover:bg-[#C9D5BD] cursor-pointer">
      Other
    </div>
  </div>

</div>
         
          </div>

        
      </div>
      </div>
     
      <div class="mt-10">
        <div class="flex lg:flex-row flex-col items-center  lg:gap-8 gap-3">
        <label class="text-[#2D2D2D] lg:text-[20px] text-[16px]  font-[400] ">
          Your Location Preference 
        </label>
        <span class="text-[16px] font-[300] text-[#7D7A74] ">(Select all that apply)</span>
        </div>

        <div class="flex lg:flex-row flex-col items-center gap-2 mt-4">
<input type="hidden" name="data[Local]" class="dropdown-hidden">
          
          <button type="button" data-pill  class="w-full pill border border-[#675F57] lg:px-6 px-4 py-[10px] rounded-full text-[#675F57] lg:text-[19px] text-[16px]  font-[400]">I want to stay within my local area</button>
         <span class="text-[16px] font-[300] text-[#7D7A74] ">and/or </span>
          <button type="button" id="relocateBtn"  data-pill  class="w-full pill border border-[#675F57] lg:px-8 px-4 py-[10px] rounded-full text-[#675F57] lg:text-[20px] text-[16px]  font-[400]">I am interested in relocating</button>
        
        </div>
         <input id="relocateField" name="data[RelocateLocation]" type="text" class="hidden w-full mt-6 p-3 text-[20px] lg:placeholder:text-[20px]
         placeholder:text-[16px] font-[400] text-center lg:pb-2 pb-4 whitespace-normal placeholder:whitespace-normal
               border-b border-[#675F57] focus:outline-0 focus:border-[#795634] text-[#4A4A4A] placeholder-[rgba(103,95,87,0.30)]"
               placeholder="(Optional) If you're interested in relocating, please describe your ideal location">

      
      </div>

      <div class="mt-10">
   

        <div class="flex lg:flex-row flex-col items-center  lg:gap-8 gap-3">
        <label class="text-[#2D2D2D] lg:text-[20px] text-[16px]  font-[400] ">
           Areas You Can Help With
        </label>
        <span class="text-[16px] font-[300] text-[#7D7A74] ">(Select all that apply)</span>
        </div>

        <div class="grid lg:grid-cols-3 grid-cols-2 gap-4 mt-8">
<input type="hidden" name="data[HelpArea]" class="dropdown-hidden">

          <button type="button" data-pill  class="pill border border-[#675F57] lg:px-8 px-4  py-[10px] 
          rounded-full text-[#675F57] lg:text-[20px] text-[16px]  font-[400]">Cooking</button>
          <button type="button" data-pill  class="pill border border-[#675F57] lg:px-8 px-4  py-[10px] 
          rounded-full text-[#675F57] lg:text-[20px] text-[16px]  font-[400]">Organizing</button>
          <button type="button" data-pill  class="pill border border-[#675F57] lg:px-8 px-4  py-[10px] 
          rounded-full text-[#675F57] lg:text-[20px] text-[16px]  font-[400]">Cleaning</button>
          <button type="button" data-pill  class="pill border border-[#675F57] lg:px-8 px-4  py-[10px] 
          rounded-full text-[#675F57] lg:text-[20px] text-[16px]  font-[400]">Pet Care</button>
            <button type="button" data-pill  class="pill border border-[#675F57] lg:px-8 px-4  py-[10px] 
          rounded-full text-[#675F57] lg:text-[20px] text-[16px]  font-[400]">Errands</button>
            <button type="button" data-pill  class="pill border border-[#675F57] lg:px-8 px-4  py-[10px] 
          rounded-full text-[#675F57] lg:text-[20px] text-[16px]  font-[400]">Child Tutoring</button>
            <button type="button" data-pill  class="pill border border-[#675F57] lg:px-8 px-0  py-[10px] 
          rounded-full text-[#675F57] lg:text-[20px] text-[16px]  font-[400]">After-School Care</button>
                      <button type="button" data-pill  class="pill border border-[#675F57] lg:px-8 px-4  py-[10px] 
          rounded-full text-[#675F57] lg:text-[20px] text-[16px]  font-[400]">Elder Care</button>
                      <button type="button" id="otherBtn" data-pill  class="pill border border-[#675F57] lg:px-8 px-4  py-[10px] 
          rounded-full text-[#675F57] lg:text-[20px] text-[16px]  font-[400]">Other</button>
 
  
        </div>
          
      </div>

      <!-- Notes -->
       <textarea id="otherField" name="data[OtherHelpArea]" class="hidden w-full mt-8 pt-3 lg:pb-0 pb-2 leading-[20px] lg:text-[20px] lg:placeholder:text-[20px]
         placeholder:text-[16px] text-[16px] font-[400] text-center
               border-b border-[#675F57] focus:outline-0 focus:border-[#795634] text-[#4A4A4A] placeholder-[rgba(103,95,87,0.30)]"
               placeholder="Please describe other tasks you can assist with"></textarea>
     

      <!-- BUTTON -->
      <div class="lg:mt-16  mx-auto relative flex items-center justify-center">
        

         <input type="submit" id="continueBtn" value="Continue" class="cursor-not-allowed duration-300 opacity-30  lg:text-[24px] text-[16px] font-[500] shadow-[0_10px_15px_-3px_rgba(0,0,0,0.10),_0_4px_6px_-4px_rgba(0,0,0,0.10)] lg:w-[560px] w-[85%] mx-auto flex items-center justify-center lg:mx-0 lg:mt-0 mt-10 bg-[#BE5103]  text-white  px-4 py-3 rounded-full ">
          
      </div>
      </form>

    </div>
  </div>
  </div>
</section>




<footer class="w-full bg-[#2E2E2E] pt-[42px] pb-[32px] lg:px-[64px] px-[24px]">
  <div class="w-full mx-auto text-center">

<img src="./assets/images/logo.png" alt="logo" class="lg:w-[124px] lg:h-[48px] w-[82px] h-[32px] mx-auto ">


    <hr class="border-[#7D7A74] lg:mb-12 mb-6 lg:mt-10 mt-5">

    <p class="text-[#7D7A74] text-[16px] font-[400]">
      © 2025 NestHelpers. All rights reserved.
    </p>
  </div>
</footer>




<!-- ======================= UPDATED JS FOR THE DROPDOWNS ======================= -->
<script>
document.addEventListener("DOMContentLoaded", () => {

  // Handle each dropdown separately
  document.querySelectorAll(".dropdown").forEach(drop => {
    const btn = drop.querySelector(".dropdown-btn");
    const menu = drop.querySelector(".dropdown-menu");
    const valueSpan = drop.querySelector(".dropdown-value");
    const hiddenInput = drop.querySelector(".dropdown-hidden"); // ⭐ NEW

    // Toggle menu
    btn.addEventListener("click", (e) => {
      e.stopPropagation();
      document.querySelectorAll(".dropdown-menu").forEach(m => {
        if (m !== menu) m.classList.add("hidden");
      });
      menu.classList.toggle("hidden");
    });

    // Handle item click
    drop.querySelectorAll("[data-option]").forEach(item => {
      item.addEventListener("click", () => {

        const selectedValue = item.textContent.trim();

        // Update visible text
        valueSpan.textContent = selectedValue;
        valueSpan.classList.remove("text-[rgba(103,95,87,0.30)]");
        valueSpan.classList.add("text-[#675F57]");

        // ⭐ UPDATE hidden input for Google Sheet
        if (hiddenInput) hiddenInput.value = selectedValue;

        menu.classList.add("hidden");
        
        // Check form validity
        if (typeof checkFormValidity === 'function') {
          setTimeout(checkFormValidity, 10);
        }
      });
    });
  });

  // Close dropdowns on outside click
  document.addEventListener("click", () => {
    document.querySelectorAll(".dropdown-menu").forEach(menu => menu.classList.add("hidden"));
  });

});
</script>



<!-- ======================= UPDATED JS FOR THE PILLS ======================= -->
<script>
  /* ======================
      PILLS LOGIC
  ====================== */

  let helpAreas = []; // ⭐ will store multiselect values
  const pills = Array.from(document.querySelectorAll("[data-pill]"));

  pills.forEach((pill, index) => {
    pill.addEventListener("click", () => {

      // Toggle UI
      pill.classList.toggle("bg-[#675F57]");
      pill.classList.toggle("text-white");
      pill.classList.toggle("border-[#675F57]");

      const val = pill.textContent.trim();
      const localInput = document.querySelector("input[name='data[Local]']");
      const relocateField = document.getElementById("relocateField");

      /* ----------------------------------
           LOCATION PREFERENCE — LOCAL
      ---------------------------------- */
      if (val === "I want to stay within my local area") {
        // Check relocate pill state (after toggle, so check if it's selected)
        const relocatePill = document.getElementById("relocateBtn");
        const isRelocateSelected = relocatePill && relocatePill.classList.contains("bg-[#675F57]");
        const relocateText = relocateField.value.trim();
        
        // After toggle, check if this pill is now selected
        if (pill.classList.contains("bg-[#675F57]")) {
          // If both are selected, combine them
          if (isRelocateSelected) {
            let baseValue = "Local area, Interested in relocating";
            // Append relocate text if user typed something
            if (relocateText) {
              localInput.value = baseValue + " - " + relocateText;
            } else {
              localInput.value = baseValue;
            }
          } else {
            localInput.value = "Local area";
          }
        } else {
          // This pill was just deselected
          // If relocate is still selected, keep that value with text
          if (isRelocateSelected) {
            let baseValue = "Interested in relocating";
            if (relocateText) {
              localInput.value = baseValue + " - " + relocateText;
            } else {
              localInput.value = baseValue;
            }
          } else {
            localInput.value = "";
          }
        }
      }

      /* ----------------------------------
           LOCATION PREFERENCE — RELOCATE
      ---------------------------------- */
      if (val === "I am interested in relocating") {
        // Toggle the relocate field visibility
        relocateField.classList.toggle("hidden");
        
        // Get the local pill state (after toggle)
        const localPill = pills.find(p => p.textContent.trim() === "I want to stay within my local area");
        const isLocalSelected = localPill && localPill.classList.contains("bg-[#675F57]");

        // After toggle, check if this pill is now selected
        if (pill.classList.contains("bg-[#675F57]")) {
          // Build the value with relocate text if available
          const relocateText = relocateField.value.trim();
          let baseValue = "Interested in relocating";
          
          if (isLocalSelected) {
            baseValue = "Local area, Interested in relocating";
          }
          
          // Append the relocate text if user typed something
          if (relocateText) {
            localInput.value = baseValue + " - " + relocateText;
          } else {
            localInput.value = baseValue;
          }
        } else {
          // This pill was just deselected - clear relocate field
          relocateField.value = "";
          // If local is still selected, keep that value
          if (isLocalSelected) {
            localInput.value = "Local area";
          } else {
            localInput.value = "";
          }
        }
      }

      /* ----------------------------------
            HELP AREAS MULTISELECT
      ---------------------------------- */
      const helpInput = document.querySelector("input[name='data[HelpArea]']");
      const otherField = document.getElementById("otherField");

      if (
        val !== "I am interested in relocating" &&
        val !== "I want to stay within my local area"
      ) {
        if (pill.classList.contains("bg-[#675F57]")) {
          helpAreas.push(val);
        } else {
          helpAreas = helpAreas.filter(v => v !== val);
        }

        // Build the help areas string
        let helpAreasStr = helpAreas.join(", ");
        
        // If "Other" is selected and has text, append it
        const isOtherSelected = helpAreas.includes("Other");
        const otherText = otherField.value.trim();
        if (isOtherSelected && otherText) {
          // Replace "Other" with "Other - [text]", but avoid duplicates
          if (!helpAreasStr.includes("Other - ")) {
            helpAreasStr = helpAreasStr.replace("Other", "Other - " + otherText);
          } else {
            // Already has "Other - ", just update the text part
            helpAreasStr = helpAreasStr.replace(/Other - [^,]+/, "Other - " + otherText);
          }
        } else if (isOtherSelected) {
          // Other is selected but no text, make sure it's just "Other"
          helpAreasStr = helpAreasStr.replace(/Other - [^,]+/, "Other");
        }
        
        helpInput.value = helpAreasStr;
      }

      /* ----------------------------------
                OTHER FIELD
      ---------------------------------- */
      if (val === "Other") {
        otherField.classList.toggle("hidden");
        // Update help areas when Other is toggled
        if (pill.classList.contains("bg-[#675F57]")) {
          // Other was just selected, update the value
          let helpAreasStr = helpAreas.join(", ");
          const otherText = otherField.value.trim();
          if (otherText) {
            // Replace "Other" with "Other - [text]", but avoid duplicates
            if (!helpAreasStr.includes("Other - ")) {
              helpAreasStr = helpAreasStr.replace("Other", "Other - " + otherText);
            } else {
              // Already has "Other - ", just update the text part
              helpAreasStr = helpAreasStr.replace(/Other - [^,]+/, "Other - " + otherText);
            }
          }
          helpInput.value = helpAreasStr;
        } else {
          // Other was just deselected, remove the text part
          helpAreas = helpAreas.filter(v => v !== "Other");
          helpInput.value = helpAreas.join(", ");
          otherField.value = "";
        }
      }

      checkFormValidity();
    });
  });

  /* ======================
      UPDATE VALUES WHEN TEXT FIELDS CHANGE
      ====================== */
  
  // Update Local input when relocate field changes
  const relocateField = document.getElementById("relocateField");
  if (relocateField) {
    relocateField.addEventListener("input", () => {
      const localInput = document.querySelector("input[name='data[Local]']");
      const relocatePill = document.getElementById("relocateBtn");
      const localPill = pills.find(p => p.textContent.trim() === "I want to stay within my local area");
      const isRelocateSelected = relocatePill && relocatePill.classList.contains("bg-[#675F57]");
      const isLocalSelected = localPill && localPill.classList.contains("bg-[#675F57]");
      const relocateText = relocateField.value.trim();
      
      if (isRelocateSelected) {
        let baseValue = "Interested in relocating";
        if (isLocalSelected) {
          baseValue = "Local area, Interested in relocating";
        }
        
        if (relocateText) {
          localInput.value = baseValue + " - " + relocateText;
        } else {
          localInput.value = baseValue;
        }
      }
    });
  }
  
  // Update HelpArea input when other field changes
  const otherField = document.getElementById("otherField");
  if (otherField) {
    otherField.addEventListener("input", () => {
      const helpInput = document.querySelector("input[name='data[HelpArea]']");
      const isOtherSelected = helpAreas.includes("Other");
      const otherText = otherField.value.trim();
      
      if (isOtherSelected) {
        let helpAreasStr = helpAreas.join(", ");
        if (otherText) {
          // Replace "Other" with "Other - [text]", but avoid duplicates
          if (!helpAreasStr.includes("Other - ")) {
            helpAreasStr = helpAreasStr.replace("Other", "Other - " + otherText);
          } else {
            // Already has "Other - ", just update the text part
            helpAreasStr = helpAreasStr.replace(/Other - [^,]+/, "Other - " + otherText);
          }
        } else {
          // No text, make sure it's just "Other"
          helpAreasStr = helpAreasStr.replace(/Other - [^,]+/, "Other");
        }
        helpInput.value = helpAreasStr;
      }
    });
  }

  /* ======================
      CHECK FORM COMPLETION
      ====================== */
  function checkFormValidity() {
    const continueBtn = document.getElementById("continueBtn");
    if (!continueBtn) return;

    const dropdowns = document.querySelectorAll(".dropdown");

    let allDropdownsFilled = true;

    const v1 = dropdowns[0].querySelector(".dropdown-value").textContent.trim();
    if (v1 === "Select") allDropdownsFilled = false;

    const v2 = dropdowns[1].querySelector(".dropdown-value").textContent.trim();
    if (v2 === "Select") allDropdownsFilled = false;

    const v3 = dropdowns[2].querySelector(".dropdown-value").textContent.trim();
    const v4 = dropdowns[3].querySelector(".dropdown-value").textContent.trim();
    if (v3 === "Age" || v4 === "Gender") allDropdownsFilled = false;

    // Location pills
    const pills = Array.from(document.querySelectorAll("[data-pill]"));
    const locationSelected = pills.slice(0, 2).some(p => p.classList.contains("bg-[#675F57]"));

    // Help areas pills
    const helpSelected = pills.slice(2).some(p => p.classList.contains("bg-[#675F57]"));

    if (allDropdownsFilled && locationSelected && helpSelected) {
      continueBtn.classList.remove("opacity-30", "cursor-not-allowed");
      continueBtn.classList.add("opacity-100", "cursor-pointer");
    } else {
      continueBtn.classList.remove("opacity-100", "cursor-pointer");
      continueBtn.classList.add("opacity-30", "cursor-not-allowed");
    }
  }

  setTimeout(checkFormValidity, 100);



  /* ======================
      BLOCK SUBMIT ON DISABLED & HANDLE AJAX SUBMISSION
  ====================== */
 

  const continueBtn = document.getElementById("continueBtn");
  const form = document.getElementById("surveyForm");

  form.addEventListener("submit", (e) => {
    // Stop submit if invalid visually
    if (continueBtn.classList.contains("opacity-30") || 
        continueBtn.classList.contains("cursor-not-allowed")) {
        e.preventDefault();
        return false;
    }

    e.preventDefault(); // Prevent default form submission

    // Disable button to prevent double submission
    continueBtn.disabled = true;

    // Collect form data and store in localStorage
    const formData = new FormData(form);
    const page1Data = {};
    
    // Convert FormData to object and store in localStorage
    // The relocate and other text are already combined into Local and HelpArea fields
    for (const [key, value] of formData.entries()) {
      if (key.startsWith('data[')) {
        page1Data[key] = value;
      }
    }
    
    // Store page 1 data in localStorage
    localStorage.setItem('surveyData', JSON.stringify(page1Data));

    // Immediately redirect - zero delay
    window.location.href = "guest-survey-page-7.html";
  });

</script>





</body>


</html>